<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: Gtk::Activatable
  
    &mdash; Documentation by YARD 0.9.27
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Gtk::Activatable";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (A)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Gtk.html" title="Gtk (module)">Gtk</a></span></span>
     &raquo; 
    <span class="title">Activatable</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: Gtk::Activatable
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>(unknown)</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Activatable widgets can be connected to a Gtk::Action and reflects the state of its action. A Gtk::Activatable can also provide feedback through its action, as they are responsible for activating their related actions.</p>

<p># Implementing GtkActivatable</p>

<p>When extending a class that is already Gtk::Activatable; it is only necessary to implement the Gtk::Activatable-&gt;sync_action_properties() and Gtk::Activatable-&gt;update() methods and chain up to the parent implementation, however when introducing a new Gtk::Activatable class; the #GtkActivatable:related-action and Gtk::Activatable:use-action-appearance properties need to be handled by the implementor. Handling these properties is mostly a matter of installing the action pointer and boolean flag on your instance, and calling gtk_activatable_do_set_related_action() and gtk_activatable_sync_action_properties() at the appropriate times.</p>

<p>## A class fragment implementing Gtk::Activatable</p>

<pre class="code ruby"><code class="ruby">enum {
...

PROP_ACTIVATABLE_RELATED_ACTION,
PROP_ACTIVATABLE_USE_ACTION_APPEARANCE
}

struct _FooBarPrivate
{

  ...

  GtkAction      *action;
  gboolean        use_action_appearance;
};

...

static void foo_bar_activatable_interface_init         (GtkActivatableIface  *iface);
static void foo_bar_activatable_update                 (GtkActivatable       *activatable,
						           GtkAction            *action,
						           const gchar          *property_name);
static void foo_bar_activatable_sync_action_properties (GtkActivatable       *activatable,
						           GtkAction            *action);
...

static void
foo_bar_class_init (FooBarClass *klass)
{

  ...

  g_object_class_override_property (gobject_class, PROP_ACTIVATABLE_RELATED_ACTION, &quot;related-action&quot;);
  g_object_class_override_property (gobject_class, PROP_ACTIVATABLE_USE_ACTION_APPEARANCE, &quot;use-action-appearance&quot;);

  ...
}

static void
foo_bar_activatable_interface_init (GtkActivatableIface  *iface)
{
  iface-&gt;update = foo_bar_activatable_update;
  iface-&gt;sync_action_properties = foo_bar_activatable_sync_action_properties;
}

... Break the reference using gtk_activatable_do_set_related_action()...

static void
foo_bar_dispose (GObject *object)
{
  FooBar *bar = FOO_BAR (object);
  FooBarPrivate *priv = FOO_BAR_GET_PRIVATE (bar);

  ...

  if (priv-&gt;action)
    {
      gtk_activatable_do_set_related_action (GTK_ACTIVATABLE (bar), NULL);
      priv-&gt;action = NULL;
    }
  G_OBJECT_CLASS (foo_bar_parent_class)-&gt;dispose (object);
}

... Handle the “related-action” and “use-action-appearance” properties ...

static void
foo_bar_set_property (GObject         *object,
                      guint            prop_id,
                      const GValue    *value,
                      GParamSpec      *pspec)
{
  FooBar *bar = FOO_BAR (object);
  FooBarPrivate *priv = FOO_BAR_GET_PRIVATE (bar);

  switch (prop_id)
    {

      ...

    case PROP_ACTIVATABLE_RELATED_ACTION:
      foo_bar_set_related_action (bar, g_value_get_object (value));
      break;
    case PROP_ACTIVATABLE_USE_ACTION_APPEARANCE:
      foo_bar_set_use_action_appearance (bar, g_value_get_boolean (value));
      break;
    default:
      G_OBJECT_WARN_INVALID_PROPERTY_ID (object, prop_id, pspec);
      break;
    }
}

static void
foo_bar_get_property (GObject         *object,
                         guint            prop_id,
                         GValue          *value,
                         GParamSpec      *pspec)
{
  FooBar *bar = FOO_BAR (object);
  FooBarPrivate *priv = FOO_BAR_GET_PRIVATE (bar);

  switch (prop_id)
    {

      ...

    case PROP_ACTIVATABLE_RELATED_ACTION:
      g_value_set_object (value, priv-&gt;action);
      break;
    case PROP_ACTIVATABLE_USE_ACTION_APPEARANCE:
      g_value_set_boolean (value, priv-&gt;use_action_appearance);
      break;
    default:
      G_OBJECT_WARN_INVALID_PROPERTY_ID (object, prop_id, pspec);
      break;
    }
}

static void
foo_bar_set_use_action_appearance (FooBar   *bar,
				   gboolean  use_appearance)
{
  FooBarPrivate *priv = FOO_BAR_GET_PRIVATE (bar);

  if (priv-&gt;use_action_appearance != use_appearance)
    {
      priv-&gt;use_action_appearance = use_appearance;

      gtk_activatable_sync_action_properties (GTK_ACTIVATABLE (bar), priv-&gt;action);
    }
}

... call gtk_activatable_do_set_related_action() and then assign the action pointer,
no need to reference the action here since gtk_activatable_do_set_related_action() already
holds a reference here for you...
static void
foo_bar_set_related_action (FooBar    *bar,
			    GtkAction *action)
{
  FooBarPrivate *priv = FOO_BAR_GET_PRIVATE (bar);

  if (priv-&gt;action == action)
    return;

  gtk_activatable_do_set_related_action (GTK_ACTIVATABLE (bar), action);

  priv-&gt;action = action;
}

... Selectively reset and update activatable depending on the use-action-appearance property ...
static void
gtk_button_activatable_sync_action_properties (GtkActivatable       *activatable,
		                                  GtkAction            *action)
{
  GtkButtonPrivate *priv = GTK_BUTTON_GET_PRIVATE (activatable);

  if (!action)
    return;

  if (gtk_action_is_visible (action))
    gtk_widget_show (GTK_WIDGET (activatable));
  else
    gtk_widget_hide (GTK_WIDGET (activatable));

  gtk_widget_set_sensitive (GTK_WIDGET (activatable), gtk_action_is_sensitive (action));

  ...

  if (priv-&gt;use_action_appearance)
    {
      if (gtk_action_get_stock_id (action))
	foo_bar_set_stock (button, gtk_action_get_stock_id (action));
      else if (gtk_action_get_label (action))
	foo_bar_set_label (button, gtk_action_get_label (action));

      ...

    }
}

static void
foo_bar_activatable_update (GtkActivatable       *activatable,
			       GtkAction            *action,
			       const gchar          *property_name)
{
  FooBarPrivate *priv = FOO_BAR_GET_PRIVATE (activatable);

  if (strcmp (property_name, &quot;visible&quot;) == 0)
    {
      if (gtk_action_is_visible (action))
	gtk_widget_show (GTK_WIDGET (activatable));
      else
	gtk_widget_hide (GTK_WIDGET (activatable));
    }
  else if (strcmp (property_name, &quot;sensitive&quot;) == 0)
    gtk_widget_set_sensitive (GTK_WIDGET (activatable), gtk_action_is_sensitive (action));

  ...

  if (!priv-&gt;use_action_appearance)
    return;

  if (strcmp (property_name, &quot;stock-id&quot;) == 0)
    foo_bar_set_stock (button, gtk_action_get_stock_id (action));
  else if (strcmp (property_name, &quot;label&quot;) == 0)
    foo_bar_set_label (button, gtk_action_get_label (action));

  ...
}
</code></pre>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#do_set_related_action-instance_method" title="#do_set_related_action (instance method)">#<strong>do_set_related_action</strong>(action)  &#x21d2; nil </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This is a utility function for Gtk::Activatable implementors.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#related_action-instance_method" title="#related_action (instance method)">#<strong>related_action</strong>  &#x21d2; Gtk::Action </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Gets the related Gtk::Action for <strong>activatable</strong>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#related_action=-instance_method" title="#related_action= (instance method)">#<strong>related_action=</strong>(action)  &#x21d2; nil </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Sets the related action on the <strong>activatable</strong> object.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#sync_action_properties-instance_method" title="#sync_action_properties (instance method)">#<strong>sync_action_properties</strong>(activatable, action)  &#x21d2; nil </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update-instance_method" title="#update (instance method)">#<strong>update</strong>(activatable, action, property_name)  &#x21d2; nil </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#use_action_appearance-instance_method" title="#use_action_appearance (instance method)">#<strong>use_action_appearance</strong>  &#x21d2; TrueClass </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Gets whether this activatable should reset its layout and appearance when setting the related action or when the action changes appearance.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#use_action_appearance=-instance_method" title="#use_action_appearance= (instance method)">#<strong>use_action_appearance=</strong>(use_appearance)  &#x21d2; nil </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Sets whether this activatable should reset its layout and appearance when setting the related action or when the action changes appearance.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="do_set_related_action-instance_method">
  
    #<strong>do_set_related_action</strong>(action)  &#x21d2; <tt>nil</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This is a utility function for Gtk::Activatable implementors.</p>

<p>When implementing Gtk::Activatable you must call this when handling changes of the Gtk::Activatable:related-action, and you must also use this to break references in #GObject-&gt;dispose().</p>

<p>This function adds a reference to the currently set related action for you, it also makes sure the Gtk::Activatable-&gt;update() method is called when the related Gtk::Action properties change and registers to the action’s proxy list.</p>

<p>&gt; Be careful to call this before setting the local &gt; copy of the Gtk::Action property, since this function uses &gt; gtk_activatable_get_related_action() to retrieve the &gt; previous action.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>action</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Action.html" title="Gtk::Action (class)">Gtk::Action</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the Gtk::Action to set</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="related_action-instance_method">
  
    #<strong>related_action</strong>  &#x21d2; <tt><span class='object_link'><a href="Action.html" title="Gtk::Action (class)">Gtk::Action</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Gets the related Gtk::Action for <strong>activatable</strong>.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Action.html" title="Gtk::Action (class)">Gtk::Action</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the related Gtk::Action if one is set.</p>
</div>
      
    </li>
  
</ul>

</div>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="related_action=-instance_method">
  
    #<strong>related_action=</strong>(action)  &#x21d2; <tt>nil</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Sets the related action on the <strong>activatable</strong> object.</p>

<p>&gt; Gtk::Activatable implementors need to handle the #GtkActivatable:related-action &gt; property and call gtk_activatable_do_set_related_action() when it changes.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>action</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Action.html" title="Gtk::Action (class)">Gtk::Action</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the Gtk::Action to set</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="sync_action_properties-instance_method">
  
    #<strong>sync_action_properties</strong>(activatable, action)  &#x21d2; <tt>nil</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>activatable</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Gtk::Activatable (module)">Gtk::Activatable</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a Gtk::Activatable</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>action</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Action.html" title="Gtk::Action (class)">Gtk::Action</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the related Gtk::Action or nil</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="update-instance_method">
  
    #<strong>update</strong>(activatable, action, property_name)  &#x21d2; <tt>nil</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>activatable</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Gtk::Activatable (module)">Gtk::Activatable</a></span></tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>action</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Action.html" title="Gtk::Action (class)">Gtk::Action</a></span></tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>property_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="use_action_appearance-instance_method">
  
    #<strong>use_action_appearance</strong>  &#x21d2; <tt>TrueClass</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Gets whether this activatable should reset its layout and appearance when setting the related action or when the action changes appearance.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>TrueClass</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>whether <strong>activatable</strong> uses its actions appearance.</p>
</div>
      
    </li>
  
</ul>

</div>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="use_action_appearance=-instance_method">
  
    #<strong>use_action_appearance=</strong>(use_appearance)  &#x21d2; <tt>nil</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Sets whether this activatable should reset its layout and appearance when setting the related action or when the action changes appearance</p>

<p>&gt; Gtk::Activatable implementors need to handle the &gt; Gtk::Activatable:use-action-appearance property and call &gt; gtk_activatable_sync_action_properties() to update <strong>activatable</strong> &gt; if needed.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>use_appearance</span>
      
      
        <span class='type'>(<tt>TrueClass</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>whether to use the actions appearance</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Sun May 22 01:00:26 2022 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.27 (ruby-3.1.2).
</div>

    </div>
  </body>
</html>